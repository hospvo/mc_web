<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Správa serveru - {{ server.name }}</title>
    
    <!-- Hlavní CSS soubory -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/server_panel.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/plugins_manager.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/mods_quickview.css') }}">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="server-panel">
        <div class="server-header">
            <button id="back-btn" class="btn btn-secondary">
                <i class="fas fa-arrow-left"></i> Zpět na Dashboard
            </button>
            <h3><i class="fas fa-server"></i> Správa serveru: <span id="server-name">{{ server.name }}</span></h3>
        </div>

        <div id="server-status-display">
            <div class="server-meta">
                <span id="server-loader" class="meta-badge">Loader: -</span>
                <span id="mc-version" class="meta-badge">MC: -</span>
            </div>

            <p><span class="status-indicator"></span> Status: <span class="status-text">Načítání...</span></p>
            <p>RAM: <span id="ram-usage">-</span> MB</p>
            <p>CPU: <span id="cpu-usage">-</span> / <span id="cpu-max">-</span></p>
            <p>Online: <span id="player-count">-</span></p>
        </div>

        <div id="online-players-panel" class="mt-3">
            <h4><i class="fas fa-users"></i> Připojení hráči (<span id="player-count-display">0</span>)</h4>
            <div id="players-table-container">
                <table id="online-players-table" class="table table-striped table-hover">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Jméno hráče</th>
                        </tr>
                    </thead>
                    <tbody id="online-players-list">
                        <!-- Players will be loaded here dynamically -->
                    </tbody>
                </table>
                <div id="no-players-message" class="text-muted">
                    Žádní hráči nejsou připojeni
                </div>
            </div>
        </div>

        <div class="server-actions mt-3">
            <button id="start-btn" class="btn btn-success"><i class="fas fa-play"></i> Start</button>
            <button id="restart-btn" class="btn btn-warning"><i class="fas fa-redo"></i> Restart</button>
            <button id="stop-btn" class="btn btn-danger"><i class="fas fa-stop"></i> Stop</button>
        </div>

        <div class="console-section">
            <div class="console-header">
                <h3><i class="fas fa-terminal"></i> Konzole serveru</h3>
            </div>

            <!-- Záložky -->
            <div class="console-tabs">
                <div class="tab active" data-tab="main">Hlavní konzole</div>
                <button id="add-log-tab" class="tab-add" title="Otevřít starý log">+</button>
            </div>

            <!-- Obsah jednotlivých záložek -->
            <div id="console-tab-content">
                <div id="tab-main" class="tab-content active">
                    <div id="log-output" class="console-output"></div>

                    <div class="console-input-bar">
                        <input type="text" id="console-input" class="console-input" placeholder="Zadej příkaz..." />
                        <button id="sendCommand" class="console-button">
                            Odeslat
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- MODÁLNÍ OKNO PRO VÝBĚR LOGU -->
            <div id="logDialog" class="log-dialog hidden">
                <div class="log-dialog-content">
                    <h4><i class="fas fa-history"></i> Vyber starý log</h4>
                    <div id="logList" class="log-list"></div>
                    <div class="dialog-actions">
                        <button id="closeLogDialog" class="dialog-btn cancel">Zavřít</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="backup-panel">
            <h3><i class="fas fa-file-archive"></i> Správa záloh</h3>

            <div class="backup-actions mb-3">
                <button id="create-backup-btn" class="btn btn-primary">
                    <i class="fas fa-plus"></i> Vytvořit zálohu
                </button>
                <input type="text" id="backup-name" placeholder="Název zálohy (volitelné)" class="form-control">
            </div>

            <div class="backup-list-container">
                <h4>Dostupné zálohy</h4>
                <div id="backup-list" class="backup-list">
                    <!-- Zálohy se načtou dynamicky -->
                </div>
            </div>
        </div>

        <div class="disk-usage-panel">
            <h3><i class="fas fa-hdd"></i> Využití disku</h3>

            <div class="combined-progress mb-3">
                <div id="server-usage-bar" class="progress-bar server-bar" style="width: 0%" title="Server"></div>
                <div id="backup-usage-bar" class="progress-bar backup-bar" style="width: 0%" title="Zálohy"></div>
            </div>

            <div class="disk-usage-details">
                <div class="usage-item">
                    <span class="usage-label"> Server:</span>
                    <span id="server-usage-text" class="usage-value">-</span>
                </div>
                <div class="usage-item">
                    <span class="usage-label"> Zálohy:</span>
                    <span id="backup-usage-text" class="usage-value">-</span>
                </div>
                <div class="usage-item">
                    <span class="usage-label"> Využito:</span>
                    <span id="total-usage-text" class="usage-value">-</span>
                </div>
                <div class="usage-item">
                    <span class="usage-label"> Počet záloh:</span>
                    <span id="backup-count" class="usage-value">-</span>
                </div>
            </div>
        </div>

        <div id="admin-management-panel" style="display: none;">
            <h3><i class="fas fa-user-shield"></i> Správa administrátorů</h3>
            <input type="email" id="admin-email-input" class="form-control mb-2" placeholder="Email admina">
            <button id="add-admin-btn" class="btn btn-primary mb-3">Přidat admina</button>

            <h4>Seznam administrátorů</h4>
            <ul id="admin-list" class="list-group mb-3">
                <!-- Seznam adminů se načte zde -->
            </ul>
        </div>

        <!-- Sekce pro pluginy (bude zobrazena pouze pro plugin servery) -->
        <div class="plugins-quickview" style="display: none;">
            <h3><i class="fas fa-puzzle-piece"></i> Nainstalované pluginy</h3>
            <div id="installed-plugins-quickview" class="plugins-list">
                <!-- Načte se dynamicky -->
            </div>
            <button id="manage-plugins-btn" class="btn btn-primary">
                <i class="fas fa-cog"></i> Spravovat pluginy
            </button>
        </div>

        <!-- Sekce pro módy (bude zobrazena pouze pro mod servery) -->
        <div class="mods-quickview" style="display: none;">
            <h3><i class="fas fa-puzzle-piece"></i> Nainstalované mody</h3>
            <div id="installed-mods-quickview" class="mods-list">
                <!-- Načte se dynamicky -->
            </div>
            <button id="manage-mods-btn" class="btn btn-primary" style="background-color: #9f7aea; border-color: #805ad5;">
                <i class="fas fa-cog"></i> Spravovat mody
            </button>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/server_panel.js') }}"></script>
</body>
</html>