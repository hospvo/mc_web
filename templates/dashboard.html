{% extends "base.html" %}
{% block title %}Dashboard{% endblock %}

{% block content %}
<div class="dashboard-container">
  <div class="welcome-banner">
    <h1><i class="fas fa-server"></i> Vítejte, {{ username }}!</h1>
    <p>Zde můžete spravovat nebo se připojit ke svým serverům.</p>
  </div>

  <!-- Sekce pro připojení k serveru pomocí kódu -->
  <section id="join-server" class="join-server-section">
    <h2><i class="fas fa-user-plus"></i> Připojit se k serveru</h2>
    <div class="join-server-card">
      <input type="text" id="access-code-input" placeholder="Zadejte přístupový kód"
             maxlength="12" class="form-control" style="text-transform: uppercase;">
      <button id="join-server-btn" class="btn btn-success">
        <i class="fas fa-sign-in-alt"></i> Připojit se
      </button>
    </div>
    <small class="text-muted">Zadejte přístupový kód, který vám poskytl administrátor serveru.</small>
  </section>

  <!-- Seznam serverů -->
  <section id="my-servers">
    <h2><i class="fas fa-list"></i> Moje servery</h2>
    
    {% if servers %}
    <div class="server-grid">
      {% for server in servers %}
      <div class="server-card">
        <div class="server-header">
          <h3>
            {{ server.name }}
            {% if server.role == 'owner' %}
              <span class="owner-badge">Vlastník</span>
            {% elif server.role == 'admin' %}
              <span class="admin-badge">Admin</span>
            {% elif server.role == 'player' %}
              <span class="player-badge">Hráč</span>
            {% endif %}
          </h3>
          <div class="server-status" data-server-id="{{ server.id }}">
            <span class="status-indicator status-loading"></span>
            <span class="status-text">Načítám...</span>
            <span class="player-count text-muted small"></span>
          </div>
        </div>
        
        <div class="server-info">
          <p><i class="fas fa-microchip"></i> Loader: {{ server.loader or '-' }}</p>
          <p><i class="fas fa-cube"></i> Verze: {{ server.mc_version or '-' }}</p>
          <p><i class="fas fa-network-wired"></i> IP: {{ server.ip }}:{{ server.port }}</p>
        </div>
        
        <div class="server-actions">
          {% if server.role in ['owner', 'admin'] %}
          <a href="{{ url_for('server_panel', server_id=server.id) }}" class="button small">
            <i class="fas fa-cog"></i> Spravovat
          </a>
          {% elif server.role == 'player' %}
          <a href="{{ url_for('player_view.player_view', server_id=server.id) }}" class="button small">
            <i class="fas fa-info-circle"></i> Info serveru
          </a>
          {% else %}
          <span class="text-muted">Bez přístupu</span>
          {% endif %}
        </div>
      </div>
      {% endfor %}
    </div>
    {% else %}
    <div class="no-servers">
      <i class="fas fa-server"></i>
      <p>Zatím nemáte žádné servery.</p>
      <a href="{{ url_for('index') }}#objednat" class="button">Objednat server</a>
    </div>
    {% endif %}
  </section>
</div>

<!-- SCRIPTS & STYLES -->
<script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
<link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/server_panel.css') }}">
{% endblock %}
